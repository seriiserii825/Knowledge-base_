## SELF JOIN

SELF JOIN - это соединение таблицы с самой собой. Используется для сравнения строк внутри одной таблицы.

### Пример данных

**Таблица: employees**

| emp_id | name            | manager_id |
| ------ | --------------- | ---------- |
| 1      | Иван Директоров | NULL       |
| 2      | Петр Менеджеров | 1          |
| 3      | Анна Сотрудник  | 2          |
| 4      | Ольга Сотрудник | 2          |
| 5      | Сергей Главный  | 1          |

### Примеры запросов

**Пример 1: Найти сотрудников и их менеджеров**

```sql
SELECT
    e.name AS employee,
    m.name AS manager
FROM employees e
LEFT JOIN employees m
ON e.manager_id = m.emp_id;
```

**Результат:**

| employee        | manager         |
| --------------- | --------------- |
| Иван Директоров | NULL            |
| Петр Менеджеров | Иван Директоров |
| Анна Сотрудник  | Петр Менеджеров |
| Ольга Сотрудник | Петр Менеджеров |
| Сергей Главный  | Иван Директоров |

**Пример 2: Найти коллег (сотрудников с одним менеджером)**

```sql
SELECT DISTINCT
    e1.name AS employee1,
    e2.name AS employee2,
    m.name AS common_manager
FROM employees e1
INNER JOIN employees e2
ON e1.manager_id = e2.manager_id
   AND e1.emp_id < e2.emp_id
INNER JOIN employees m
ON e1.manager_id = m.emp_id;
```

**Пример 3: Иерархический запрос (два уровня)**

```sql
SELECT
    e.name AS employee,
    m.name AS manager,
    gm.name AS grand_manager
FROM employees e
LEFT JOIN employees m ON e.manager_id = m.emp_id
LEFT JOIN employees gm ON m.manager_id = gm.emp_id;
```

---
