# 30 –ó–∞–¥–∞—á SQL GROUP BY - TeaShop Database

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã:

- **users** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (id, name, email, picture, role, createdAt)
- **stores** - –º–∞–≥–∞–∑–∏–Ω—ã (id, title, description, user_id, picture, createdAt)
- **categories** - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (id, title, description, store_id, createdAt)
- **colors** - —Ü–≤–µ—Ç–∞ (id, name, value, store_id, createdAt)
- **products** - —Ç–æ–≤–∞—Ä—ã (id, title, description, price, images, store_id, category_id, color_id, user_id, createdAt)
- **orders** - –∑–∞–∫–∞–∑—ã (id, status, total, user_id, createdAt)
- **order_items** - –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫–∞–∑–∞ (id, order_id, product_id, quantity, price, store_id, createdAt)
- **reviews** - –æ—Ç–∑—ã–≤—ã (id, text, rating, user_id, product_id, store_id, createdAt)

## –ó–∞–¥–∞—á–∏

### –£—Ä–æ–≤–µ–Ω—å 1: –ë–∞–∑–æ–≤—ã–µ –∑–∞–¥–∞—á–∏

**1.** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

```sql
SELECT category_id, COUNT(*) AS product_count
FROM products
GROUP BY category_id;
```

**2.** –í—ã–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞.

```sql
SELECT store_id, AVG(price) AS product_avg
FROM products
GROUP BY store_id;
```

**3.** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```sql
SELECT user_id, COUNT(*) AS orders_count
FROM orders
GROUP BY user_id;
```

**4.** –ù–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞.

```sql
SELECT store_id, COUNT(*) AS reviews_count
FROM reviews
GROUP BY store_id;
```

**5.** –í—ã–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ü–≤–µ—Ç–∞.

```sql
SELECT color_id, COUNT(color_id) AS color_count
FROM products
GROUP BY color_id;
```

**6.** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ.

```sql
SELECT store_id, COUNT(*) AS products_count
FROM products
GROUP BY store_id;
```

**7.** –ù–∞–π–¥–∏—Ç–µ —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ (rating) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞.

```sql
SELECT product_id, AVG(rating) AS rating_avg
FROM reviews
GROUP BY product_id;
```

**8.** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –∫–∞–∂–¥–æ–º –≥–æ–¥—É.

```sql
SELECT EXTRACT(YEAR FROM "createdAt") AS year, COUNT(*) AS user_count
FROM users
GROUP BY EXTRACT(YEAR FROM "createdAt")
ORDER BY year;
```

**9.** –í—ã–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ.

```sql
SELECT store_id, COUNT(\*) AS category_count
FROM categories
GROUP BY store_id
```

**10.** –ù–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º PENDING –∏ PAID –æ—Ç–¥–µ–ª—å–Ω–æ.

### –£—Ä–æ–≤–µ–Ω—å 2: –°—Ä–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏

**11.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –Ω–∞–π–¥–∏—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∏ —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–∞.

**12.** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–±—â—É—é —Å—É–º–º—É (total) –≤—Å–µ—Ö –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**13.** –ù–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ –∏ —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞.

**14.** –î–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—ã–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∏—Ö —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É.

**15.** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü (quantity) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞.

**16.** –ù–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤ (—É –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**17.** –í—ã–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –æ–±—â—É—é —Å—É–º–º—É –ø—Ä–æ–¥–∞–∂ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É order_items.

**18.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ü–≤–µ—Ç–∞ –Ω–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –∏ –∏—Ö –æ–±—â—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å (price \* –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤).

**19.** –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**20.** –ù–∞–π–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –æ—Å—Ç–∞–≤–∏–≤—à–∏—Ö –æ—Ç–∑—ã–≤—ã –≤ –∫–∞–∂–¥–æ–º –º–∞–≥–∞–∑–∏–Ω–µ.

### –£—Ä–æ–≤–µ–Ω—å 3: –°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏

**21.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –Ω–∞–π–¥–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã –∏–ª–∏ JOIN).

**22.** –í—ã–≤–µ–¥–∏—Ç–µ —Ç–æ–ø-3 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.

**23.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤ –∏ —Å—Ä–µ–¥–Ω—é—é –æ—Ü–µ–Ω–∫—É, –∫–æ—Ç–æ—Ä—É—é –æ–Ω —Å—Ç–∞–≤–∏—Ç.

**24.** –ù–∞–π–¥–∏—Ç–µ —Ç–æ–≤–∞—Ä—ã, —É –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤—ã—à–µ 4.5 –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤ –±–æ–ª—å—à–µ 5.

**25.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞ 2024 –≥–æ–¥–∞ –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –∏ –æ–±—â—É—é –≤—ã—Ä—É—á–∫—É.

**26.** –í—ã–≤–µ–¥–∏—Ç–µ –º–∞–≥–∞–∑–∏–Ω—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –æ–±—â—É—é —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É –ø–æ –≤—Å–µ–π –±–∞–∑–µ.

**27.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞–π–¥–∏—Ç–µ –æ–±—â—É—é —Å—É–º–º—É –µ–≥–æ –∑–∞–∫–∞–∑–æ–≤ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –∑–∞–∫–∞–∑–∞–ª.

**28.** –ù–∞–π–¥–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å—Ç–æ—è—Ç –¥–æ—Ä–æ–∂–µ 1000 —Ä—É–±–ª–µ–π.

**29.** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

**30.** –í—ã–≤–µ–¥–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–¥–µ–ª–∞–ª–∏ –∑–∞–∫–∞–∑—ã –±–æ–ª–µ–µ —á–µ–º –≤ 3 —Ä–∞–∑–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö, —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç—Ç–∏—Ö –º–∞–≥–∞–∑–∏–Ω–æ–≤.

---

## –ü–æ–¥—Å–∫–∞–∑–∫–∏

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `COUNT()`, `AVG()`, `SUM()`, `MIN()`, `MAX()`
- –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≥—Ä—É–ø–ø –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `HAVING`
- –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç–∞–º–∏: `DATE_FORMAT()`, `YEAR()`, `MONTH()`
- –î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: `COUNT(DISTINCT column)`
- –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è `JOIN` –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –ü–æ–º–Ω–∏—Ç–µ –ø—Ä–æ `ORDER BY` –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `LIMIT` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ø-N –∑–∞–ø–∏—Å–µ–π

–£–¥–∞—á–∏! üçµ
